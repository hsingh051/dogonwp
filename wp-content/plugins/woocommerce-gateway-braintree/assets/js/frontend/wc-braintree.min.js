jQuery(document).ready(function(a){"use strict";function b(b){var c=a("input[name=braintree-cc-token]:radio").filter(":checked").val(),f=[],g=a("#braintree-cc-number").val(),h=a("#braintree-cc-cvv").val(),i=a("#braintree-cc-exp-month").val(),j=a("#braintree-cc-exp-year").val();if("undefined"!=typeof c&&""!==c)return"undefined"!=typeof h?(h?/\D/.test(h)?f.push(braintree_params.cvv_invalid):(h.length<3||h.length>4)&&f.push(braintree_params.cvv_length_invalid):f.push(braintree_params.cvv_missing),f.length>0?(a(".woocommerce-error, .woocommerce-message").remove(),b.prepend('<ul class="woocommerce-error"><li>'+f.join("</li><li>")+"</li></ul>"),b.removeClass("processing").unblock(),b.find(".input-text, select").blur(),a("html, body").animate({scrollTop:b.offset().top-100},1e3),!1):(e.encryptForm(b),!0)):!0;g=g.replace(/-|\s/g,""),g?(g.length<12||g.length>19||/\D/.test(g)||!d(g))&&f.push(braintree_params.card_number_invalid):f.push(braintree_params.card_number_missing);var k=(new Date).getFullYear();return(/\D/.test(i)||/\D/.test(j)||i>12||1>i||k>j||j>k+20)&&f.push(braintree_params.card_exp_date_invalid),"undefined"!=typeof h&&(h?/\D/.test(h)?f.push(braintree_params.cvv_invalid):(h.length<3||h.length>4)&&f.push(braintree_params.cvv_length_invalid):f.push(braintree_params.cvv_missing)),f.length>0?(a(".woocommerce-error, .woocommerce-message").remove(),b.prepend('<ul class="woocommerce-error"><li>'+f.join("</li><li>")+"</li></ul>"),b.removeClass("processing").unblock(),b.find(".input-text, select").blur(),a("html, body").animate({scrollTop:b.offset().top-100},1e3),!1):(a("#braintree-cc-number").val(g),e.encryptForm(b),!0)}function c(){a("input[name=braintree-cc-token]:radio").change(function(){var b=a(this).filter(":checked").val(),c=a("div.braintree-new-card"),d=a("#braintree-cc-cvv-section");""!==b?(c.slideUp(200),d.removeClass("form-row-last")):(c.slideDown(200),d.addClass("form-row-last "))}).change()}function d(a){var b,c,d,e=0;for(b=0,c=a.length;c-1>b;b++)d=parseInt(a.substr(c-(b+2),1)*(2-b%2),10),e+=10>d?d:d-9;return parseInt(a.substr(c-1),10)===(10-e%10)%10}var e=Braintree.create(braintree_params.cse_key);a("form.checkout").length?(a(document.body).bind("updated_checkout",function(){c()}),a("form.checkout").bind("checkout_place_order_braintree",function(){return b(a(this))})):(c(),a("form#order_review").submit(function(){return"braintree"===a("#order_review input[name=payment_method]:checked").val()?b(a(this)):void 0}))});
